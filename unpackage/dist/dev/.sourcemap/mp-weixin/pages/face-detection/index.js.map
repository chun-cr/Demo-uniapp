{"version":3,"sources":["uni-app:///main.js","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?3e55","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?f224","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?7247","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?ffa7","uni-app:///pages/face-detection/index.vue","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?c962","webpack:///D:/documents/HBuilderProject1/demo2/pages/face-detection/index.vue?87f4"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","args","fn","timer","name","data","devicePosition","cameraHeight","cameraContext","cameraListener","isScanning","isDetecting","isLoading","qualifiedTime","faceRect","visible","x","y","width","height","facePoints","faceFrame","scaleX","scaleY","resultImg","confidence","facePosition","faceSize","statusText","statusClass","takePhotoTimer","detectionTimer","computed","cameraStyle","onLoad","onUnload","methods","initCamera","success","console","fail","startDetection","handleFrameData","frameBuffer","enablePoint","enableConf","enableAngle","enableMultiFace","handleFaceData","faceWidthRate","Math","handleDetectionError","takePhoto","countdown","clearInterval","capturePhoto","quality","setTimeout","showDetectionResult","uni","title","content","showCancel","confirmText","stopDetection","restartDetection","switchCamera","setStatus","clearTimers","clearTimeout","errorCamera"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AACyM;AACzM,gBAAgB,gNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAgyB,CAAgB,8xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACCpzB;EACA;EACA;IACA;MAAA,kCADAC;QAAAA;MAAA;MAEAC;MACAC;QACAA;MACA;IACA;EACA;AACA;AAAA,eACA;EACAC;EACAC;IACA;MACA;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;QACAN;QACAG;QACAC;MACA;MACAG;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MAEA;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;QACAd;MACA;IACA;EACA;EAEAe;IACA;EACA;EAEAC;IACA;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;QACAzC;UACA0C;YACAC;YACA;UACA;UACAC;YACAD;YACA;UACA;QACA;MACA;;MAEA;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;MACA;IACA;IAEA;IACAE;MAAA;MACA;MACA;MACA;MACA;MACA;;MAEA;MACA;QACA;MACA;MAEA;;MAEA;MACA;QACA;UACA;UACA;QACA;MAEA;IACA;IAEA;IACAC;MAAA;MACA;MAEA;QACAxB;QACAC;MACA;;MAEA;MACA;MACA;;MAEA;MACA;QACAvB;UACA+C;UAAA;UACAzB;UAAA;UACAC;UAAA;UACAyB;UAAA;UACAC;UAAA;UACAC;UAAA;UACAC;UAAA;UACAT;YACA;UACA;UACAE;YACA;UACA;QACA;MACA;IACA;IAEA;IACAQ;MACA;QACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;QACA;MACA;MAEA;;MAEA;MACA;QACAjC;QACAC;QACAC;QACAC;QACAC;MACA;;MAEA;MACA;QACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;;MAEA;MACA;MACA;MAEA;QACA;QACA;QACA;MACA;QACA;QACA;QAEA,2DACA,2DACA,2DACA;MACA;;MAEA;MACA,kBACA,uBACA8B,8CACAC,uCACAA,qCACAA,qCACA;MACA;QAAA;MAAA;QACA;UACA;QACA;MACA;QACA;UACA;QACA;UACA;QACA;UACA;QACA;UACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACAZ;MACA;MACA;IACA;IAEA;IACAa;MAAA;MACA;MAEA;MACA;MAEA;QACAC;QACA;UACA;QACA;UACAC;UACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACAC;QACAlB;UACA;UACA;UACA;UAEA;YACA;UACA;UAEA;;UAEA;UACAmB;YACA;UACA;QACA;QACAjB;UACAD;UACA;UACA;QACA;MACA;IACA;IAEA;IACAmB;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MAEA;QACA;MACA;MAEA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MAEA;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA;IACA;IAEA;IACAC;MACA;QACAd;QACA;MACA;MACA;QACAe;QACA;MACA;IACA;IAEA;IACAC;MACA/B;MACAoB;QACAC;QACAC;QACAC;QACAxB;UACAqB;QACA;MACA;IACA;EAEA;AAEA;AAAA,2B;;;;;;;;;;;;;AC1XA;AAAA;AAAA;AAAA;AAAm8C,CAAgB,03CAAG,EAAC,C;;;;;;;;;;;ACAv9C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/face-detection/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/face-detection/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=219f955e&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/face-detection/index.vue\"\nexport default component.exports","export * from \"-!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=219f955e&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<script>\r\nfunction throttle(fn, delay) {\r\n  let timer = null;\r\n  return function(...args) {\r\n    if (!timer) {\r\n      fn.apply(this, args);\r\n      timer = setTimeout(() => {\r\n        timer = null;\r\n      }, delay);\r\n    }\r\n  };\r\n}\r\nexport default {\r\n  name: \"index\",\r\n  data(){\r\n    return{\r\n      //Áõ∏Êú∫Áõ∏ÂÖ≥\r\n      devicePosition: 'front',\r\n      cameraHeight: 0,\r\n      cameraContext: null,\r\n      cameraListener: null,\r\n\r\n      //Ê£ÄÊµãÁä∂ÊÄÅ\r\n      isScanning: false,\r\n      isDetecting: false,\r\n      isLoading: false,\r\n      qualifiedTime:0,\r\n\r\n      //Èù¢ÈÉ®Êï∞ÊçÆ\r\n      faceRect: {\r\n        visible: false,\r\n        x: 0,\r\n        y: 0,\r\n        width: 0,\r\n        height: 0\r\n      },\r\n      facePoints: [],\r\n      faceFrame: {\r\n        visible: false,\r\n        width: 0,\r\n        height: 0\r\n      },\r\n      scaleX: 1,\r\n      scaleY: 1,\r\n\r\n      //Ê£ÄÊµãÁªìÊûú\r\n      resultImg: '',\r\n      confidence: 0,\r\n      facePosition: 'Êú™Ê£ÄÊµãÂà∞',\r\n      faceSize: '0%',\r\n\r\n      //Áä∂ÊÄÅÊèêÁ§∫\r\n      statusText: 'ËØ∑Â∞Ü‰∫∫ËÑ∏ÁΩÆ‰∫éÊ°ÜÂÜÖ',\r\n      statusClass: 'status-default',\r\n\r\n      // ÂÆöÊó∂Âô®\r\n      takePhotoTimer: null,\r\n      detectionTimer: null\r\n    }\r\n  },\r\n  computed: {\r\n    cameraStyle() {\r\n      return {\r\n        height: this.cameraHeight + 'px'\r\n      };\r\n    }\r\n  },\r\n\r\n  onLoad(){\r\n    this.initCamera()\r\n  },\r\n\r\n  onUnload(){\r\n    this.stopDetection();\r\n    this.clearTimers();\r\n  },\r\n\r\n  methods: {\r\n    //ÂàùÂßãÂåñÁõ∏Êú∫\r\n    initCamera() {\r\n      this.isLoading = true;\r\n\r\n      //Ëé∑ÂèñÁ™óÂè£È´òÂ∫¶\r\n      const systemInfo = uni.getSystemInfoSync();\r\n      this.cameraHeight = systemInfo.windowHeight * 0.7;\r\n\r\n      //ÂàùÂßãÂåñÂæÆ‰ø°‰∫∫ËÑ∏Ê£ÄÊµã\r\n      if (typeof wx !== 'undefined' && wx.initFaceDetect){\r\n        wx.initFaceDetect({\r\n          success: () => {\r\n            console.log('‰∫∫ËÑ∏ÂàùÂßãÂåñÊàêÂäü')\r\n            this.setStatus('ÂàùÂßãÂåñÊàêÂäüÔºåÂèØ‰ª•ÂºÄÂßãÊ£ÄÊµã','success');\r\n          },\r\n          fail: (err) => {\r\n            console.log('‰∫∫ËÑ∏ÂàùÂßãÂåñÂ§±Ë¥•', err)\r\n            this.setStatus('ÂàùÂßãÂåñÂ§±Ë¥•','error');\r\n          }\r\n        });\r\n      }\r\n\r\n      //ÂàõÂª∫Áõ∏Êú∫‰∏ä‰∏ãÊñá\r\n      this.cameraContext = uni.createCameraContext();\r\n      if(!this.cameraContext){\r\n        this.setStatus('ËØ∑Ê£ÄÊü•Áõ∏Êú∫ÊùÉÈôê','error');\r\n        this.isLoading = false;\r\n        return;\r\n      }\r\n\r\n      this.isLoading = false;\r\n      this.setStatus('ÂáÜÂ§áÂ∞±Áª™ÔºåÁÇπÂáªÂºÄÂßãÊ£ÄÊµã','default')\r\n    },\r\n\r\n    //ÂºÄÂßãÊ£ÄÊµã\r\n    startDetection() {\r\n      if(this.isScanning || this.isLoading) return;\r\n      this.isScanning = true;\r\n      this.qualifiedTime = 0;\r\n      this.clearTimers()\r\n      this.setStatus('ÂºÄÂßãÊ£ÄÊµã‰∏≠...','scanning');\r\n\r\n      //ÂºÄÂßãÁõëÂê¨Áõ∏Êú∫Â∏ß\r\n      this.cameraListener = this.cameraContext.onCameraFrame(frame => {\r\n        this.handleFrameData(frame)\r\n      });\r\n\r\n      this.cameraListener.start()\r\n\r\n      //Ê∑ªÂä†Ê£ÄÊµãË∂ÖÊó∂\r\n      this.detectionTimer = setTimeout(() => {\r\n        if(this.isScanning && !this.isDetecting){\r\n          this.setStatus('Ê£ÄÊµãË∂ÖÊó∂ÔºåËØ∑ÈáçÊñ∞ÂºÄÂßã','error');\r\n          this.stopDetection();\r\n        }\r\n\r\n      }, 3000);\r\n    },\r\n\r\n    //Â§ÑÁêÜÂ∏ßÊï∞ÊçÆ\r\n    handleFrameData: throttle(function(frame){\r\n      if(!this.isScanning) return;\r\n\r\n      this.faceFrame = {\r\n        width: frame.width,\r\n        height: frame.height\r\n      };\r\n\r\n      //ËÆ°ÁÆóÁº©ÊîæÊØî‰æã\r\n      this.scaleX = uni.getSystemInfoSync().windowWidth / frame.width;\r\n      this.scaleY = (this.cameraHeight) / frame.height;\r\n\r\n      //Ë∞ÉÁî®‰∫∫ËÑ∏Ê£ÄÊµã\r\n      if (typeof wx !== 'undefined' && wx.faceDetect){\r\n        wx.faceDetect({\r\n          frameBuffer: frame.data, // Ê†∏ÂøÉÔºöÁõ∏Êú∫Â∏ßÂéüÂßãÂÉèÁ¥†Êï∞ÊçÆÔºàABGR Ê†ºÂºè Uint8ArrayÔºâ\r\n          width: frame.width,      // Â∏ßÂõæÂÉèÂÆΩÂ∫¶Ôºà‰∏é frameBuffer ÂåπÈÖçÔºâ\r\n          height: frame.height,    // Â∏ßÂõæÂÉèÈ´òÂ∫¶Ôºà‰∏é frameBuffer ÂåπÈÖçÔºâ\r\n          enablePoint: true,       // ÊòØÂê¶ËøîÂõû‰∫∫ËÑ∏ÂÖ≥ÈîÆÁÇπÔºàÂ¶ÇÁúºÁùõ„ÄÅÈºªÂ≠ê„ÄÅÂò¥Â∑¥ÂùêÊ†áÔºâ\r\n          enableConf: true,        // ÊòØÂê¶ËøîÂõû‰∫∫ËÑ∏ÁΩÆ‰ø°Â∫¶Ôºà0-1ÔºåË∂äÈ´òË∂äÂèØËÉΩÊòØ‰∫∫ËÑ∏Ôºâ\r\n          enableAngle: true,       // ÊòØÂê¶ËøîÂõû‰∫∫ËÑ∏ÂßøÊÄÅËßíÂ∫¶Ôºà‰øØ‰ª∞Ëßí„ÄÅÂÅèËà™Ëßí„ÄÅÊªöËΩ¨ËßíÔºâ\r\n          enableMultiFace: false,  // ÊòØÂê¶ÊîØÊåÅÂ§ö‰∫∫ËÑ∏Ê£ÄÊµãÔºàfalse=Âè™Ê£ÄÊµã1Âº†‰∫∫ËÑ∏Ôºâ\r\n          success: (faceData) => {\r\n            this.handleFaceData(faceData);\r\n          },\r\n          fail: (err) => {\r\n            this.handleDetectionError(err);\r\n          }\r\n        });\r\n      }\r\n    },200),\r\n\r\n    //Â§ÑÁêÜ‰∫∫ËÑ∏Êï∞ÊçÆ\r\n    handleFaceData(faceData) {\r\n      if (faceData.x === -1 || faceData.y === -1){\r\n        this.faceRect.visible = false;\r\n        this.setStatus('Êú™Ê£ÄÊµãÂà∞‰∫∫ËÑ∏ÔºåËØ∑ÈáçÊñ∞ÂºÄÂßã','warning');\r\n        this.qualifiedTime = 0;\r\n        return ;\r\n      }\r\n\r\n      if (faceData.faceInfo.length > 1){\r\n        this.setStatus('Ê£ÄÊµãÂà∞Â§ö‰∏™‰∫∫ËÑ∏ÔºåËØ∑Á°Æ‰øùÂè™Êúâ‰∏Ä‰∏™‰∫∫ËÑ∏','warning');\r\n        this.qualifiedTime = 0;\r\n        return;\r\n      }\r\n\r\n      const face = faceData.faceInfo[0];\r\n\r\n      //Êõ¥Êñ∞Èù¢ÈÉ®Áü©Èòµ\r\n      this.faceRect = {\r\n        visible: true,\r\n        x: face.detectRect.originX * this.scaleX,\r\n        y: face.detectRect.originY * this.scaleY,\r\n        width: face.detectRect.width * this.scaleX,\r\n        height: face.detectRect.height * this.scaleY\r\n      };\r\n\r\n      //Êõ¥Êñ∞ÂÖ≥ÈîÆÁÇπ\r\n      if(face.pointArray){\r\n        this.facePoints = face.pointArray.slice(0, 10);\r\n      }\r\n\r\n      //ËÆ°ÁÆóÈù¢ÈÉ®Âú®ÁîªÈù¢‰∏≠ÁöÑÊØî‰æã\r\n      const faceWidthRate = face.detectRect.width / this.faceFrame.width;\r\n      this.faceSize = Math.round(face.confArray.global * 100) + '%';\r\n\r\n      //ËÆ°ÁÆóÁΩÆ‰ø°Â∫¶\r\n      this.confidence = Math.round(face.confArray.global * 100);\r\n\r\n      //Èù¢ÈÉ®‰ΩçÁΩÆÂà§Êñ≠\r\n      const centerX =face.x / this.faceFrame.width;\r\n      const centerY = face.y / this.faceFrame.height;\r\n\r\n      if (centerX > 0.4 && centerX < 0.6 && centerY > 0.4 && centerY < 0.6) {\r\n        this.facePosition = '‰∏≠ÂøÉ‰ΩçÁΩÆ ‚úì';\r\n        this.qualifiedTime++;\r\n        this.setStatus(`Èù¢ÈÉ®‰ΩçÁΩÆËâØÂ•ΩÔºå‰øùÊåÅ ${this.qualifiedTime}/3`, 'success');\r\n      } else {\r\n        this.facePosition = 'ÈúÄË¶ÅË∞ÉÊï¥';\r\n        this.qualifiedTime = 0;\r\n\r\n        if (centerX < 0.4) this.setStatus('ËØ∑ÂêëÂè≥ÁßªÂä®', 'warning');\r\n        else if (centerX > 0.6) this.setStatus('ËØ∑ÂêëÂ∑¶ÁßªÂä®', 'warning');\r\n        else if (centerY < 0.4) this.setStatus('ËØ∑Âêë‰∏ãÁßªÂä®', 'warning');\r\n        else this.setStatus('ËØ∑Âêë‰∏äÁßªÂä®', 'warning');\r\n      }\r\n\r\n      //Ê£ÄÊµãÈÄöËøáÊù°‰ª∂\r\n      const conditions = [\r\n          this.confidence >= 80,\r\n          faceWidthRate >= 0.4 && faceWidthRate <= 0.7,\r\n          Math.abs(face.angleArray.pitch) < 0.3,\r\n          Math.abs(face.angleArray.yaw) < 0.3,\r\n          Math.abs(face.angleArray.roll) < 0.3\r\n      ];\r\n      if (conditions.every(cond => cond)) {\r\n        if (this.qualifiedTime >= 3) {\r\n          this.takePhoto();\r\n        }\r\n      } else {\r\n        if (this.confidence < 80) {\r\n          this.setStatus('Èù¢ÈÉ®Ê∏ÖÊô∞Â∫¶‰∏çË∂≥ÔºåËØ∑Ê≠£ÂØπÂÖâÊ∫ê', 'warning');\r\n        } else if (faceWidthRate < 0.4) {\r\n          this.setStatus('Èù¢ÈÉ®Â§™Â∞èÔºåËØ∑Èù†ËøëÊëÑÂÉèÂ§¥', 'warning');\r\n        } else if (faceWidthRate > 0.7) {\r\n          this.setStatus('Èù¢ÈÉ®Â§™Â§ßÔºåËØ∑ËøúÁ¶ªÊëÑÂÉèÂ§¥', 'warning');\r\n        } else if (Math.abs(face.angleArray.pitch) >= 0.3) {\r\n          this.setStatus('ËØ∑Âπ≥ËßÜÊëÑÂÉèÂ§¥', 'warning');\r\n        }\r\n        this.qualifiedTime = Math.max(0, this.qualifiedTime - 1);\r\n      }\r\n    },\r\n    // Â§ÑÁêÜÊ£ÄÊµãÈîôËØØ\r\n    handleDetectionError(err) {\r\n      console.error('‰∫∫ËÑ∏Ê£ÄÊµãÂ§±Ë¥•:', err);\r\n      this.faceRect.visible = false;\r\n      this.setStatus('Ê£ÄÊµãÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');\r\n    },\r\n\r\n    // ÊãçÁÖß\r\n    takePhoto() {\r\n      if (this.takePhotoTimer) return;\r\n\r\n      this.setStatus('ÂáÜÂ§áÊãçÁÖß... 3', 'success');\r\n      let countdown = 3;\r\n\r\n      this.takePhotoTimer = setInterval(() => {\r\n        countdown--;\r\n        if (countdown > 0) {\r\n          this.setStatus(`ÂáÜÂ§áÊãçÁÖß... ${countdown}`, 'success');\r\n        } else {\r\n          clearInterval(this.takePhotoTimer);\r\n          this.takePhotoTimer = null;\r\n          this.capturePhoto();\r\n        }\r\n      }, 1000);\r\n    },\r\n\r\n    // ÊçïËé∑ÁÖßÁâá\r\n    capturePhoto() {\r\n      this.cameraContext.takePhoto({\r\n        quality: 'high',\r\n        success: (res) => {\r\n          this.resultImg = res.tempImagePath;\r\n          this.isDetecting = false;\r\n          this.isScanning = false;\r\n\r\n          if (this.cameraListener) {\r\n            this.cameraListener.stop();\r\n          }\r\n\r\n          this.setStatus('Ê£ÄÊµãÂÆåÊàêÔºÅ', 'success');\r\n\r\n          // ÊòæÁ§∫Ê£ÄÊµãÁªìÊûú\r\n          setTimeout(() => {\r\n            this.showDetectionResult();\r\n          }, 500);\r\n        },\r\n        fail: (err) => {\r\n          console.error('ÊãçÁÖßÂ§±Ë¥•:', err);\r\n          this.setStatus('ÊãçÁÖßÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');\r\n          this.stopDetection();\r\n        }\r\n      });\r\n    },\r\n\r\n    // ÊòæÁ§∫Ê£ÄÊµãÁªìÊûú\r\n    showDetectionResult() {\r\n      uni.showModal({\r\n        title: 'Ê£ÄÊµãÂÆåÊàê',\r\n        content: `Èù¢ÈÉ®Ê£ÄÊµãÊàêÂäüÔºÅ\\nÁΩÆ‰ø°Â∫¶Ôºö${this.confidence}%\\nÈù¢ÈÉ®Â§ßÂ∞èÔºö${this.faceSize}`,\r\n        showCancel: false,\r\n        confirmText: 'Â•ΩÁöÑ'\r\n      });\r\n    },\r\n\r\n    // ÂÅúÊ≠¢Ê£ÄÊµã\r\n    stopDetection() {\r\n      this.isScanning = false;\r\n      this.qualifiedTime = 0;\r\n      this.faceRect.visible = false;\r\n\r\n      if (this.cameraListener) {\r\n        this.cameraListener.stop();\r\n      }\r\n\r\n      this.clearTimers();\r\n      this.setStatus('Ê£ÄÊµãÂ∑≤ÂÅúÊ≠¢', 'default');\r\n    },\r\n\r\n    // ÈáçÊñ∞ÂºÄÂßãÊ£ÄÊµã\r\n    restartDetection() {\r\n      this.isDetecting = false;\r\n      this.resultImg = '';\r\n      this.faceRect.visible = false;\r\n      this.setStatus('ÂáÜÂ§áÂºÄÂßãÊ£ÄÊµã', 'default');\r\n    },\r\n\r\n    // ÂàáÊç¢ÊëÑÂÉèÂ§¥\r\n    switchCamera() {\r\n      if (this.isScanning || this.isLoading) return;\r\n\r\n      this.devicePosition = this.devicePosition === 'front' ? 'back' : 'front';\r\n      this.setStatus(`Â∑≤ÂàáÊç¢‰∏∫${this.devicePosition === 'front' ? 'ÂâçÁΩÆ' : 'ÂêéÁΩÆ'}ÊëÑÂÉèÂ§¥`, 'info');\r\n    },\r\n\r\n    // ËÆæÁΩÆÁä∂ÊÄÅÊèêÁ§∫\r\n    setStatus(text, type = 'default') {\r\n      this.statusText = text;\r\n      this.statusClass = `status-${type}`;\r\n    },\r\n\r\n    // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n    clearTimers() {\r\n      if (this.takePhotoTimer) {\r\n        clearInterval(this.takePhotoTimer);\r\n        this.takePhotoTimer = null;\r\n      }\r\n      if (this.detectionTimer) {\r\n        clearTimeout(this.detectionTimer);\r\n        this.detectionTimer = null;\r\n      }\r\n    },\r\n\r\n    // Áõ∏Êú∫ÈîôËØØÂ§ÑÁêÜ\r\n    errorCamera(e) {\r\n      console.error('Áõ∏Êú∫ÈîôËØØ:', e);\r\n      uni.showModal({\r\n        title: 'Áõ∏Êú∫ÈîôËØØ',\r\n        content: 'ËØ∑Ê£ÄÊü•Áõ∏Êú∫ÊùÉÈôêÊòØÂê¶ÂºÄÂêØ',\r\n        showCancel: false,\r\n        success: () => {\r\n          uni.navigateBack();\r\n        }\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<template>\r\n  <view class=\"page-container\">\r\n    <camera v-if=\"!isDectecting\"\r\n            mode=\"normal\"\r\n            :device-position=\"devicePosition\"\r\n            resolution=\"high\"\r\n            frame-size=\"medium\"\r\n            :style=\"{height : cameraHeight + 'px'}\"\r\n            @error=\"handleCamera\"\r\n            >\r\n      <view class=\"camera-overlay\">\r\n<!--        ‰∫∫ËÑ∏Ê£ÄÊµãÊ°Ü-->\r\n        <view\r\n          v-if=\"faceRect.visible\"\r\n          class=\"face-rect\"\r\n          :style=\"{\r\n            top: faceRect.x + 'px',\r\n            left: faceRect.y + 'px',\r\n            width: faceRect.width + 'px',\r\n            height: faceRect.height + 'px'\r\n          }\"\r\n        >\r\n          <view class=\"face-rect-border\"></view>\r\n          <view class=\"face-rect-points\">\r\n            <view\r\n              v-for=\"(point, index) in facePoints\"\r\n              :key=\"index\"\r\n              class=\"face-point\"\r\n              :style=\"{\r\n                top: (point.y * scaleX) + 'px',\r\n                left: (point.x * scaleY) + 'px'\r\n              }\"\r\n            ></view>\r\n          </view>\r\n        </view>\r\n\r\n<!--        ‰∏≠ÂøÉÂå∫Âüü-->\r\n        <view class=\"center-area\">\r\n          <view class=\"center-rect\"></view>\r\n          <view class=\"center-dot\"></view>\r\n        </view>\r\n      </view>\r\n    </camera>\r\n\r\n<!--    Ê£ÄÊµãÁªìÊûúÂ±ïÁ§∫-->\r\n    <view v-if=\"isDetecting\" class=\"result-container\">\r\n      <image :src=\"resultImg\" mode=\"withFix\" class=\"result-image\"></image>\r\n      <view class=\"result-title\">Ê£ÄÊµãÁªìÊûú</view>\r\n      <view class=\"info-item\">\r\n        <text class=\"label\">Èù¢ÈÉ®‰ΩçÁΩÆÔºö</text>\r\n        <text class=\"value\">{{ facePosition.visible ? `(${facePosition.x}, ${facePosition.y})` : 'Êú™Ê£ÄÊµãÂà∞‰∫∫ËÑ∏' }}</text>\r\n      </view><view class=\"info-item\">\r\n        <text class=\"label\">Èù¢ÈÉ®Â§ßÂ∞èÔºö</text>\r\n        <text class=\"value\">{{ faceSize }}</text>\r\n      </view><view class=\"info-item\">\r\n        <text class=\"label\">ÁΩÆ‰ø°Â∫¶Ôºö</text>\r\n        <text class=\"value\">{{ confidence }}</text>\r\n      </view>\r\n    </view>\r\n\r\n<!--    ÊéßÂà∂Èù¢Êùø-->\r\n    <view class=\"contro-panel\">\r\n      <view class=\"status-info\">\r\n        <text class=\"status-text\" :class=\"statusClass\">{{ statusText }}</text>\r\n        <text v-if=\"qualifiedTime > o\" class=\"countdown\"> {{ qualifiedTime }} </text>\r\n      </view>\r\n\r\n      <view class=\"button-group\">\r\n        <button\r\n          v-if=\"!isScanning && !isDetecting\"\r\n          class=\"btn start-btn\"\r\n          :disabled=\"isLoading\"\r\n          @tap=\"startDetection\"\r\n          >\r\n          <view class=\"btn-icon\">‚ñ∂</view>\r\n          <text class=\"btn-text\">ÂºÄÂßãÊ£ÄÊµã</text>\r\n        </button>\r\n\r\n        <!-- ÂÅúÊ≠¢ÊåâÈíÆ -->\r\n        <button\r\n            v-if=\"isScanning && !isDetecting\"\r\n            class=\"btn stop-btn\"\r\n            @tap=\"stopDetection\"\r\n        >\r\n          <view class=\"btn-icon\">‚è∏</view>\r\n          <text class=\"btn-text\">ÂÅúÊ≠¢Ê£ÄÊµã</text>\r\n        </button>\r\n\r\n        <!-- ÈáçÊñ∞Ê£ÄÊµãÊåâÈíÆ -->\r\n        <button\r\n            v-if=\"isDetecting\"\r\n            class=\"btn restart-btn\"\r\n            @tap=\"restartDetection\"\r\n        >\r\n          <view class=\"btn-icon\">‚Üª</view>\r\n          <text class=\"btn-text\">ÈáçÊñ∞Ê£ÄÊµã</text>\r\n        </button>\r\n\r\n<!--        ÂàáÊç¢ÊëÑÂÉèÂ§¥-->\r\n        <button\r\n          class=\"btn flip-btn\"\r\n          :disabled=\"isScanning || isDetecting\"\r\n          @tap=\"switchCamera\">\r\n          <view class=\"btn-icon\">üîÑ</view>\r\n          <text class=\"btn-text\">ÂàáÊç¢ÊëÑÂÉèÂ§¥</text>\r\n        </button>\r\n\r\n<!--        Âä†ËΩΩÊèêÁ§∫-->\r\n        <view v-if=\"isLoading\" class=\"loading-overlay\">\r\n          <view class=\"loading-spinner\"></view>\r\n          <text class=\"loading-text\">ÂàùÂßãÂåñ‰∏≠...</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n  </view>\r\n\r\n</template>\r\n\r\n<style lang=\"less\">\r\n.page-container {\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-color: #000;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.camera-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  pointer-events: none;\r\n}\r\n\r\n// ‰∫∫ËÑ∏Ê£ÄÊµãÊ°ÜÊ†∑Âºè\r\n.face-rect {\r\n  position: absolute;\r\n  border: 2px solid #3efefe;\r\n  border-radius: 8px;\r\n  box-shadow: 0 0 10px rgba(62, 254, 254, 0.5);\r\n\r\n  .face-rect-border {\r\n    position: absolute;\r\n    top: -2px;\r\n    left: -2px;\r\n    right: -2px;\r\n    bottom: -2px;\r\n    border: 1px solid rgba(255, 255, 255, 0.3);\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n.face-point {\r\n  position: absolute;\r\n  width: 4px;\r\n  height: 4px;\r\n  background-color: #3efefe;\r\n  border-radius: 50%;\r\n  transform: translate(-50%, -50%);\r\n  box-shadow: 0 0 4px rgba(62, 254, 254, 0.8);\r\n}\r\n\r\n// ‰∏≠ÂøÉÂå∫Âüü\r\n.center-area {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 100px;\r\n  height: 100px;\r\n\r\n  .center-rect {\r\n    width: 100%;\r\n    height: 100%;\r\n    border: 1px dashed rgba(255, 255, 255, 0.3);\r\n    border-radius: 10px;\r\n  }\r\n\r\n  .center-dot {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    width: 6px;\r\n    height: 6px;\r\n    background-color: #ff3b30;\r\n    border-radius: 50%;\r\n    transform: translate(-50%, -50%);\r\n  }\r\n}\r\n\r\n// ÊéßÂà∂Èù¢Êùø\r\n.control-panel {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);\r\n  padding: 20rpx;\r\n  padding-bottom: env(safe-area-inset-bottom);\r\n}\r\n\r\n.status-info {\r\n  text-align: center;\r\n  margin-bottom: 20rpx;\r\n\r\n  .status-text {\r\n    font-size: 28rpx;\r\n    font-weight: bold;\r\n    padding: 10rpx 30rpx;\r\n    border-radius: 50rpx;\r\n    display: inline-block;\r\n\r\n    &.status-default {\r\n      background-color: rgba(255, 255, 255, 0.1);\r\n      color: #fff;\r\n    }\r\n\r\n    &.status-scanning {\r\n      background-color: rgba(62, 254, 254, 0.2);\r\n      color: #3efefe;\r\n    }\r\n\r\n    &.status-success {\r\n      background-color: rgba(52, 199, 89, 0.2);\r\n      color: #34c759;\r\n    }\r\n\r\n    &.status-warning {\r\n      background-color: rgba(255, 149, 0, 0.2);\r\n      color: #ff9500;\r\n    }\r\n\r\n    &.status-error {\r\n      background-color: rgba(255, 59, 48, 0.2);\r\n      color: #ff3b30;\r\n    }\r\n\r\n    &.status-info {\r\n      background-color: rgba(0, 122, 255, 0.2);\r\n      color: #007aff;\r\n    }\r\n  }\r\n\r\n  .countdown {\r\n    display: block;\r\n    font-size: 32rpx;\r\n    color: #3efefe;\r\n    margin-top: 10rpx;\r\n    font-weight: bold;\r\n  }\r\n}\r\n\r\n.button-group {\r\n  display: flex;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 20rpx;\r\n}\r\n\r\n.btn {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 20rpx 30rpx;\r\n  border: none;\r\n  border-radius: 20rpx;\r\n  background: rgba(255, 255, 255, 0.1);\r\n  backdrop-filter: blur(10px);\r\n  min-width: 200rpx;\r\n  transition: all 0.3s;\r\n\r\n  &:active {\r\n    transform: scale(0.95);\r\n  }\r\n\r\n  &:disabled {\r\n    opacity: 0.5;\r\n    filter: grayscale(1);\r\n  }\r\n\r\n  .btn-icon {\r\n    font-size: 40rpx;\r\n    margin-bottom: 10rpx;\r\n  }\r\n\r\n  .btn-text {\r\n    font-size: 24rpx;\r\n    color: #fff;\r\n  }\r\n\r\n  &.start-btn {\r\n    background: linear-gradient(135deg, #34c759, #2ecc71);\r\n  }\r\n\r\n  &.stop-btn {\r\n    background: linear-gradient(135deg, #ff3b30, #ff375f);\r\n  }\r\n\r\n  &.restart-btn {\r\n    background: linear-gradient(135deg, #007aff, #5856d6);\r\n  }\r\n\r\n  &.flip-btn {\r\n    background: linear-gradient(135deg, #5ac8fa, #34c759);\r\n  }\r\n}\r\n\r\n// Ê£ÄÊµãÁªìÊûúÂ±ïÁ§∫\r\n.result-container {\r\n  background-color: #000;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  .result-image {\r\n    flex: 1;\r\n    width: 100%;\r\n  }\r\n\r\n  .result-info {\r\n    background: rgba(0, 0, 0, 0.8);\r\n    padding: 30rpx;\r\n\r\n    .result-title {\r\n      display: block;\r\n      font-size: 36rpx;\r\n      color: #fff;\r\n      font-weight: bold;\r\n      margin-bottom: 30rpx;\r\n      text-align: center;\r\n    }\r\n\r\n    .info-item {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 20rpx;\r\n\r\n      .label {\r\n        color: #999;\r\n        font-size: 28rpx;\r\n      }\r\n\r\n      .value {\r\n        color: #3efefe;\r\n        font-size: 28rpx;\r\n        font-weight: bold;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Âä†ËΩΩÊèêÁ§∫\r\n.loading-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n\r\n  .loading-spinner {\r\n    width: 80rpx;\r\n    height: 80rpx;\r\n    border: 4rpx solid rgba(255, 255, 255, 0.1);\r\n    border-top-color: #3efefe;\r\n    border-radius: 50%;\r\n    animation: spin 1s linear infinite;\r\n    margin-bottom: 30rpx;\r\n  }\r\n\r\n  .loading-text {\r\n    color: #fff;\r\n    font-size: 28rpx;\r\n  }\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n</style>","import mod from \"-!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1769563611636\n      var cssReload = require(\"D:/download/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}